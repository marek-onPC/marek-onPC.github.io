import{s as Q,c as R,o as X,a as Y,b as Z,u as ee,g as te,d as se,r as ne,n as M}from"../chunks/scheduler.DK69kJ6-.js";import{S as le,i as oe,e as x,c as T,a as O,d as g,k as y,g as D,l as h,m as A,n as p,o as V,s as N,f as I,p as j,h as C,q as F,r as q,u as B,v as U,w as z,t as ae,b as re}from"../chunks/index.DXYEYIF_.js";import{g as E}from"../chunks/entry.KhD8MUh5.js";import{r as ie,s as G}from"../chunks/stores.BzW_rP8-.js";import{f as ue,L as K}from"../chunks/fetchClient.CzNcX0_V.js";import{M as ce}from"../chunks/Modal.BbZ8QzMi.js";function fe(o){let t,s,e,n,a,d,u,b="All sheets",r,i,k="Logout",m,v,L,H,c=o[0]&&J(o);const P=[de,me],$=[];function W(l,f){return l[1]?0:1}n=W(o),a=$[n]=P[n](o);const S=o[6].default,_=Z(S,o,o[5],null);return{c(){c&&c.c(),t=N(),s=x("nav"),e=x("button"),a.c(),d=N(),u=x("a"),u.textContent=b,r=N(),i=x("button"),i.textContent=k,m=N(),_&&_.c(),this.h()},l(l){c&&c.l(l),t=I(l),s=T(l,"NAV",{class:!0});var f=O(s);e=T(f,"BUTTON",{class:!0});var w=O(e);a.l(w),w.forEach(g),d=I(f),u=T(f,"A",{class:!0,href:!0,"data-svelte-h":!0}),j(u)!=="svelte-1xorwtz"&&(u.textContent=b),r=I(f),i=T(f,"BUTTON",{class:!0,"data-svelte-h":!0}),j(i)!=="svelte-smu2c1"&&(i.textContent=k),f.forEach(g),m=I(l),_&&_.l(l),this.h()},h(){y(e,"class","button navigation__button svelte-1x46xmd"),e.disabled=o[1],y(u,"class","button navigation__button svelte-1x46xmd"),y(u,"href","/dashboard"),y(i,"class","button navigation__button svelte-1x46xmd"),y(s,"class","navigation svelte-1x46xmd")},m(l,f){c&&c.m(l,f),D(l,t,f),D(l,s,f),C(s,e),$[n].m(e,null),C(s,d),C(s,u),C(s,r),C(s,i),D(l,m,f),_&&_.m(l,f),v=!0,L||(H=[F(e,"click",o[3]),F(i,"click",o[4])],L=!0)},p(l,f){l[0]?c?(c.p(l,f),f&1&&p(c,1)):(c=J(l),c.c(),p(c,1),c.m(t.parentNode,t)):c&&(V(),h(c,1,1,()=>{c=null}),A());let w=n;n=W(l),n!==w&&(V(),h($[w],1,1,()=>{$[w]=null}),A(),a=$[n],a||(a=$[n]=P[n](l),a.c()),p(a,1),a.m(e,null)),(!v||f&2)&&(e.disabled=l[1]),_&&_.p&&(!v||f&32)&&ee(_,S,l,l[5],v?se(S,l[5],f,null):te(l[5]),null)},i(l){v||(p(c),p(a),p(_,l),v=!0)},o(l){h(c),h(a),h(_,l),v=!1},d(l){l&&(g(t),g(s),g(m)),c&&c.d(l),$[n].d(),_&&_.d(l),L=!1,ne(H)}}}function _e(o){let t,s;return t=new K({}),{c(){q(t.$$.fragment)},l(e){B(t.$$.fragment,e)},m(e,n){U(t,e,n),s=!0},p:M,i(e){s||(p(t.$$.fragment,e),s=!0)},o(e){h(t.$$.fragment,e),s=!1},d(e){z(t,e)}}}function J(o){let t,s;return t=new ce({props:{isOpened:o[0],text:"Token expired, logging out",hasLoader:!0}}),{c(){q(t.$$.fragment)},l(e){B(t.$$.fragment,e)},m(e,n){U(t,e,n),s=!0},p(e,n){const a={};n&1&&(a.isOpened=e[0]),t.$set(a)},i(e){s||(p(t.$$.fragment,e),s=!0)},o(e){h(t.$$.fragment,e),s=!1},d(e){z(t,e)}}}function me(o){let t;return{c(){t=ae("Create new")},l(s){t=re(s,"Create new")},m(s,e){D(s,t,e)},i:M,o:M,d(s){s&&g(t)}}}function de(o){let t,s;return t=new K({props:{isSmall:!0,isWhite:!0}}),{c(){q(t.$$.fragment)},l(e){B(t.$$.fragment,e)},m(e,n){U(t,e,n),s=!0},i(e){s||(p(t.$$.fragment,e),s=!0)},o(e){h(t.$$.fragment,e),s=!1},d(e){z(t,e)}}}function pe(o){let t,s,e,n,a;const d=[_e,fe],u=[];function b(r,i){return i&4&&(s=null),s==null&&(s=!r[2].token||r[2].expiry<new Date),s?0:1}return e=b(o,-1),n=u[e]=d[e](o),{c(){t=x("div"),n.c(),this.h()},l(r){t=T(r,"DIV",{class:!0});var i=O(t);n.l(i),i.forEach(g),this.h()},h(){y(t,"class","dashboard svelte-1x46xmd")},m(r,i){D(r,t,i),u[e].m(t,null),a=!0},p(r,[i]){let k=e;e=b(r,i),e===k?u[e].p(r,i):(V(),h(u[k],1,1,()=>{u[k]=null}),A(),n=u[e],n?n.p(r,i):(n=u[e]=d[e](r),n.c()),p(n,1),n.m(t,null))},i(r){a||(p(n),a=!0)},o(r){h(n),a=!1},d(r){r&&g(t),u[e].d()}}}function he(o,t,s){let e;R(o,G,m=>s(2,e=m));let{$$slots:n={},$$scope:a}=t,d=!1,u=!1,b=!1,r;const i=async()=>{try{s(1,d=!0),u=!1;const m=await ue("/cheat_sheets",e.token,{title:"New cheat sheet",is_published:!1});E(`/dashboard/cs-edit/${m.id}`)}catch{s(1,d=!1),u=!0}s(1,d=!1)},k=()=>{ie(),G.set({token:"",expiry:new Date}),E("/login")};return X(()=>{if(!e.token||e.expiry<new Date){E("/login");return}r=setInterval(()=>{e.expiry<new Date&&s(0,b=!0)},1e4)}),Y(()=>clearInterval(r)),o.$$set=m=>{"$$scope"in m&&s(5,a=m.$$scope)},o.$$.update=()=>{o.$$.dirty&1&&b&&setTimeout(()=>{k()},1500)},[b,d,e,i,k,a,n]}class ye extends le{constructor(t){super(),oe(this,t,he,pe,Q,{})}}export{ye as component};
